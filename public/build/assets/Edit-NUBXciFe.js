import{r as b,j as e,y as p}from"./app-CnOHzCej.js";import{u as _,C as n}from"./index.esm-CJDsY06h.js";import{S as N}from"./sweetalert2.all-kUifg-7A.js";import{u as B,d as C,C as E}from"./index-BXac2Q0w.js";const D={display:"flex",flexDirection:"row",flexWrap:"wrap",marginTop:16},S={display:"inline-flex",borderRadius:2,border:"1px solid #eaeaea",marginBottom:8,marginRight:8,width:100,height:100,padding:4,boxSizing:"border-box"},F={position:"relative",display:"flex",minWidth:0,overflow:"hidden"},R={display:"block",width:"auto",height:"100%"};function q({catgory:g,product:a}){const{handleSubmit:h,setValue:c,control:i,formState:{errors:f}}=_(),[m,u]=b.useState([]),{getRootProps:j,getInputProps:y}=B({accept:{"image/*":[]},onDrop:async t=>{const s=new FormData;for(let r=0;r<t.length;r++)s.append("product_images[]",t[r]);try{const r=await axios.post("product/images/"+a.id,s,{headers:{"Content-Type":"multipart/form-data"}});for(let o=0;o<r.data.length;o++)u(l=>[...l,{url:r.data[o].url,id:l.length,image_id:r.data[o].image_id}])}catch(r){console.error("Error uploading images:",r)}}}),v=async(t,s)=>{try{const r=await axios.delete("product/images/"+s,{headers:{"Content-Type":"multipart/form-data"}}),o=m.filter((l,d)=>l.image_id!==s);u(o)}catch(r){console.error("Error uploading images:",r)}};b.useEffect(()=>{c("product_name",a.product_name),c("product_title",a.product_title),c("product_price",a.product_price),c("product_detail",a.product_detail),c("product_status",a.product_status),c("cat_id",a.cat_id),a==null||a.product_images.map((t,s)=>{const r=`http://backoffice.amboss.cc/images/product/${a.id}/${t.image_names}`;console.log("url",r),u(o=>[...o,{url:r,id:s,image_id:t.id}])})},[a]);const k=m.map(t=>e.jsx("div",{style:S,children:e.jsxs("div",{style:F,children:[e.jsx("img",{src:t.url,style:R,onLoad:()=>{URL.revokeObjectURL(t.url)}}),e.jsx("button",{type:"button",onClick:()=>v(t.id,t.image_id),className:"absolute bottom-0 right-0 p-1 bg-red-500 rounded-full text-white text-xs",style:{zIndex:1},children:"Delete"})]})},t.id)),w=t=>{N.fire({title:"บันทึกข้อมูล",text:"คุณต้องการบันทึกข้อมูลหรือไม่",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"บันทึกข้อมูล",cancelButtonText:"ยกเลิก"}).then(s=>{s.isConfirmed&&p.put("/product/edit/"+a.id,t)})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"content-wrapper",children:[e.jsx("div",{className:"content-header",children:e.jsx("div",{className:"container-fluid",children:e.jsxs("div",{className:"row mb-2",children:[e.jsx("div",{className:"col-sm-6",children:e.jsx("h1",{className:"m-0",children:"สินค้า"})}),e.jsx("div",{className:"col-sm-6",children:e.jsxs("ol",{className:"breadcrumb float-sm-right",children:[e.jsx("li",{className:"breadcrumb-item",children:e.jsx("a",{href:"#",children:"หน้าแรก"})}),e.jsx("li",{className:"breadcrumb-item active",children:"สินค้า"})]})})]})})}),e.jsx("div",{className:"container-lg bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700",children:e.jsxs("form",{onSubmit:h(w),children:[e.jsxs("div",{className:"grid gap-6 mb-6 md:grid-cols-1  p-3",children:[e.jsxs("div",{children:[e.jsx("label",{for:"product_name",className:"block mb-2 text-sm font-medium text-gray-900",children:"ชื่อสินค้า"}),e.jsx(n,{control:i,name:"product_name",rules:{required:!0},render:({field:{onChange:t,onBlur:s,value:r,referrors:o},fieldState:{errors:l}})=>e.jsx("input",{type:"text",id:"product_name",value:r,className:`border  border-gray-300  text-black-500 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 
                                    dark:placeholder-gray-400 dark:focus:ring-blue-500 dark:focus:border-blue-500 
                                 ${l?"border border-red-500":""}`,onChange:t,placeholder:"กรุณารอกชื่อสินค้า"})}),f.product_name&&e.jsx("p",{className:"text-red-500",children:"กรุณากรอกข้อมูล"})]}),e.jsxs("div",{children:[e.jsx("label",{for:"product_title",class:"block mb-2 text-sm font-medium text-gray-90",children:"ลำดับ"}),e.jsx(n,{control:i,name:"product_title",rules:{required:!0},render:({field:{onChange:t,onBlur:s,value:r,ref:o}})=>e.jsx("input",{type:"text",value:r,id:"product_title",className:`border border-gray-300  text-black-500 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  dark:placeholder-gray-400
                                  dark:focus:ring-blue-500 dark:focus:border-blue-500`,onChange:t,placeholder:"คำอธิบายย่อ"})})]}),e.jsxs("div",{children:[e.jsx("label",{for:"product_detail",className:"block mb-2 text-sm font-medium text-gray-90",children:"รายละเอียด"}),e.jsx(n,{control:i,name:"product_detail",render:({field:{onChange:t,onBlur:s,value:r,ref:o}})=>e.jsx(C.CKEditor,{editor:E,data:r,onReady:l=>{console.log("Editor is ready to use!",l)},onChange:(l,d)=>{const x=d.getData();t(x),console.log({event:l,editor:d,data:x})},onBlur:(l,d)=>{console.log("Blur.",d)},onFocus:(l,d)=>{console.log("Focus.",d)}})})]}),e.jsxs("div",{children:[e.jsx("label",{for:"product_price",class:"block mb-2 text-sm font-medium text-gray-90",children:"ราคา"}),e.jsx(n,{control:i,name:"product_price",rules:{required:!0},render:({field:{onChange:t,onBlur:s,value:r,ref:o}})=>e.jsx("input",{type:"text",value:r,id:"product_title",className:`border border-gray-300  text-black-500 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5  dark:placeholder-gray-400
                                  dark:focus:ring-blue-500 dark:focus:border-blue-500`,onChange:t,placeholder:"ราคา"})})]}),e.jsxs("div",{children:[e.jsx("label",{for:"catory",className:"block mb-2 text-sm font-medium text-gray-900 ",children:"หมวดหมู่"}),e.jsx(n,{control:i,name:"cat_id",render:({field:{onChange:t,onBlur:s,value:r,ref:o}})=>e.jsxs("select",{value:r,onChange:t,className:"w-full border border-gray-300  text-black-500 text-sm rounded-lg",children:[e.jsx("option",{value:"",children:"<--กรุณาเลือก-->"}),g.map((l,d)=>e.jsx("option",{value:l.id,children:l.cat_name}))]})})]}),e.jsxs("div",{children:[e.jsx("label",{for:"product_status",className:"block mb-2 text-sm font-medium text-gray-900 ",children:"เปิด/ปิด"}),e.jsx(n,{control:i,name:"product_status",render:({field:{onChange:t,onBlur:s,value:r,ref:o}})=>e.jsxs("select",{value:r,onChange:t,className:"w-full border border-gray-300  text-black-500 text-sm rounded-lg",children:[e.jsx("option",{value:"เปิดใช้งาน",children:"<--กรุณาเลือก-->"}),e.jsx("option",{value:"1",children:"เปิดใช้งาน"}),e.jsx("option",{value:"0",children:"ปิดใช้งาน"})]})})]}),e.jsxs("div",{children:[e.jsx("label",{for:"product_images",className:"block mb-2 text-sm font-medium text-gray-900 ",children:"รูปสินค้า"}),e.jsx(n,{control:i,name:"product_images",render:({field:{onChange:t,onBlur:s,value:r,ref:o}})=>e.jsxs("section",{className:"container",children:[e.jsxs("div",{...j({className:"dropzone"}),children:[e.jsx("input",{...y()}),e.jsxs("div",{class:"w-[400px] relative border-2 border-gray-300 border-dashed rounded-lg p-6",id:"dropzone",children:[e.jsx("input",{type:"file",class:"absolute inset-0 w-full h-full opacity-0 z-50"}),e.jsxs("div",{class:"text-center",children:[e.jsx("img",{class:"mx-auto h-12 w-12",src:"https://www.svgrepo.com/show/357902/image-upload.svg",alt:""}),e.jsx("h3",{class:"mt-2 text-sm font-medium text-gray-900",children:e.jsxs("label",{for:"file-upload",class:"relative cursor-pointer",children:[e.jsx("span",{children:"Drag and drop"}),e.jsx("span",{class:"text-indigo-600",children:" or browse"}),e.jsx("span",{children:"to upload"}),e.jsx("input",{id:"file-upload",name:"file-upload",type:"file",class:"sr-only"})]})}),e.jsx("p",{class:"mt-1 text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]}),e.jsx("img",{src:"",class:"mt-4 mx-auto max-h-40 hidden",id:"preview"})]})]}),e.jsx("aside",{style:D,children:k})]})})]})]}),e.jsxs("div",{className:"my-12 p-3",children:[e.jsx("button",{type:"submit",className:"text-white mr-3 bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",children:"บันทึกข้อมูล"}),e.jsx("button",{type:"button",onClick:()=>{p.get("/product")},className:"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-blue-800",children:"ยกเลิก"})]})]})})]})})}export{q as default};
